"0","binned_asym <- fread(""Unibind_outputs_bins_genes.txt"")"
"0","colnames(binned_asym) <- c(""bin"", ""feature"", ""same"", ""oposite"", ""ratio"", ""p.value"")"
"0","binned_asym[ , pos:=str_remove(bin, ""gencode.v33.basic.annotation.bed.genes_protein_coding.formatted_bin_"")]"
"0","binned_asym[ , pos:=as.numeric(str_remove(pos, "".txt"")) ]"
"2","NAs introduced by coercion"
"0","binned_asym[ like(bin,""upstream""), pos:=-1 ]"
"0","binned_asym[ like(bin,""downstream""), pos:=12 ]"
"0","binned_asym[, feature:=str_remove(feature, ""_hg38.txt"")]"
"0","binned_asym$feature <- factor(binned_asym$feature, levels = c('LTR', 'MIR', 'Alu', 'SINE', 'L2', 'L1', 'LINE'))"
"0","binned_asym.stats <-  binned_asym[pos %in% 1:10, .(  cor = cor(ratio, pos, method=""pearson"") ,"
"0","                              adj.p.val = cor.test(ratio, pos, method=""pearson"")$p.value * length(levels(binned_asym$feature)) ) , by=""feature""]"
"0","binned_asym.stats[ , signif:="""" ]"
"0","binned_asym.stats[adj.p.val<0.05, signif:=""*"" ]"
"0","binned_asym.stats[adj.p.val<0.01, signif:=""**"" ]"
"0","binned_asym.stats[adj.p.val<0.001, signif:=""***"" ]"
"0","binned_asym.stats[ , cor:=round(cor, 2)]"
"0","Fig3.B <- ggplot(binned_asym) +"
"0","  geom_tile(aes(pos, feature, fill=ratio )) +"
"0","  scale_fill_gradient2( midpoint = 0.5, limits=c(0.2,0.8)) +"
"0","  theme_bw() +"
"0","    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +"
"0","  xlab(""Relative gene position"") +"
"0","  ylab("""") +"
"0","  scale_x_continuous(breaks=c(-1, 1:10, 12),"
"0","                     labels=c(""Upstream 1kB"", ""0-10%"", ""10-20%"",""20-30%"",""30-40%"",""40-50%"",""50-60%"",""60-70%"",""70-80%"",""80-90%"",""90-100%"",""Downstream 1kB"")) +"
"0","  labs(fill=""Strand asymmetry"") +"
"0","  geom_text(data =  binned_asym.stats,   aes( 5.5 , feature , label =  paste0(cor, "" "", signif )), size=3) "
