"0","Unibind.upstream <- fread(""./Unibind_outputs_upstream.txt"")"
"0","Unibind.downstream <- fread(""./Unibind_outputs_downstream.txt"")"
"0","colnames(Unibind.upstream) <- c(""Cell"", ""TF"", ""same"", ""opposite"", ""ratio"", ""adj.p.val"")"
"0","colnames(Unibind.downstream) <- c(""Cell"", ""TF"", ""same"", ""opposite"", ""ratio"", ""adj.p.val"")"
"0","Unibind.upstream[ , signf:=FALSE]"
"0","Unibind.upstream[ adj.p.val < 0.05  , signf:=TRUE]"
"0","Unibind.upstream[ signf==TRUE ,  N.signf:=.N  , by=""TF""]"
"0","Unibind.upstream[  ,  N.total:=.N  , by=""TF""]"
"0","Unibind.upstream[ is.na(N.signf) , N.signf:=0 ]"
"0","Unibind.upstream[ , signf.ratio:= (N.signf/ N.total) ]"
"0","Unibind.downstream[ , signf:=FALSE]"
"0","Unibind.downstream[ adj.p.val < 0.05  , signf:=TRUE]"
"0","Unibind.downstream[ signf==TRUE ,  N.signf:=.N  , by=""TF""]"
"0","Unibind.downstream[  ,  N.total:=.N  , by=""TF""]"
"0","Unibind.downstream[ is.na(N.signf) , N.signf:=0 ]"
"0","Unibind.downstream[ , signf.ratio:= (N.signf/ N.total) ]"
"0","top.hits.upstream <-  Unibind.upstream[ , .N , by=c(""TF"",  ""N.signf"", ""N.total"" , ""signf.ratio"")  ][order(-signf.ratio, -N.total)][N>=4 & signf.ratio>=0.75,  ]"
"0","Unibind.top_TF.upstream <- Unibind.upstream[ TF %in% top.hits.upstream[ , TF],  ]"
"0","Unibind.top_TF.upstream$TF <- factor(Unibind.top_TF.upstream$TF, levels= Unibind.top_TF.upstream[ , .(median=median(ratio)) , by=""TF""][order(-median)]$TF)"
"0","Unibind.top_TF.upstream[ , text:=paste0(N.signf, ""/"", N.total )]"
"0","top.hits.downstream <-  Unibind.downstream[ , .N , by=c(""TF"",  ""N.signf"", ""N.total"" , ""signf.ratio"")  ][order(-signf.ratio, -N.total)][N>=4 & signf.ratio>=0.75,  ]"
"0","Unibind.top_TF.downstream <- Unibind.downstream[ TF %in% top.hits.downstream[ , TF],  ]"
"0","Unibind.top_TF.downstream$TF <- factor(Unibind.top_TF.downstream$TF, levels= Unibind.top_TF.downstream[ , .(median=median(ratio)) , by=""TF""][order(-median)]$TF)"
"0","Unibind.top_TF.downstream[ , text:=paste0(N.signf, ""/"", N.total )]"
"0","fig4.f <- ggplot( Unibind.top_TF.upstream  ) +"
"0","  geom_boxplot( aes( TF, ratio )) +"
"0","  ylim( c(0.3, 0.7 )) +"
"0","  theme_bw() +"
"0","  geom_hline( yintercept = 0.5, colour=""red"", linetype=""dashed"" ) +"
"0","  geom_text(data =  top.hits.upstream,   aes( TF , 0.7 , label =  paste0(N.signf, ""/"", N.total )), position = position_dodge(0.9)) +"
"0","  xlab("""") +"
"0","  ylab("""")"
"0","fig4.g <- ggplot( Unibind.top_TF.downstream  ) +"
"0","  geom_boxplot( aes( TF, ratio )) +"
"0","  ylim( c(0.3, 0.7 )) +"
"0","  theme_bw() +"
"0","  geom_hline( yintercept = 0.5, colour=""red"", linetype=""dashed"" ) +"
"0","  geom_text(data =  top.hits.downstream,   aes( TF , 0.7 , label =  paste0(N.signf, ""/"", N.total )), position = position_dodge(0.9)) +"
"0","  xlab("""") +"
"0","  ylab("""") "
