"0","```r


ME_clusters.info <- merge(PCA_loadings, ME_cluster_names, by=\"ME_cluster\")

ME_clusters.info[ME_cluster.type==\"Neuronal\" | ME_cluster.type==\"Neuromuscular\"]


library(readr)

library(Hmisc)


Tasic_sample_info <- data.table(read_delim(\"~/Google_Drive/Results/ME/Single_cell/Tasic/GSE71585.txt\", 
    \"\t\", escape_double = FALSE, trim_ws = TRUE))


Tasic_clustering <- data.table(read_delim(\"~/Google_Drive/Results/ME/Single_cell/Tasic/GSE71585_Clustering_Results.csv\", 
    \",\", escape_double = FALSE, trim_ws = TRUE))

tasic_et_al_ST3 <- data.table(read_csv(\"~/Google_Drive/Results/ME/Single_cell/Tasic/tasic_et_al.ST3.csv\"))



tasic_metadata <- merge(Tasic_sample_info, tasic_et_al_ST3, by.x=\"Sample_Name_s\", by.y=\"GEO Sample Accession\")

tasic_metadata <- tasic_metadata[, c(\"Run_s\", \"GEO Sample Title\") ]


tasic_metadata <- merge( Tasic_clustering, tasic_metadata, by.x=\"sample_title\", by.y=\"GEO Sample Title\")





ME_cov_filtered_tasic <- merge( ME_cov, 
       tasic_metadata[, c(\"sample_title\", \"broad_type\", \"core_intermediate\", \"primary_type\", \"Run_s\")],
       by.x=\"FILE_NAME\", by.y = \"Run_s\")


ME_cov_filtered_tasic <-  ME_cov_filtered_tasic[ME %in% ME_final[, ME]  , ]


ME_cov_filtered_tasic$sum_ME_coverage <-  sapply(strsplit(as.character(ME_cov_filtered_tasic$ME_coverages), \",\", fixed=T), function(x) sum(as.numeric(x)))
ME_cov_filtered_tasic$sum_SJ_coverage <-  sapply(strsplit(as.character(ME_cov_filtered_tasic$SJ_coverages), \",\", fixed=T), function(x) sum(as.numeric(x)))


#ME_cov_filtered_tasic[, `:=`( total_cov_alternatives_5=Alt5_coverages, total_cov_alternatives_3=Alt3_coverages)]
ME_cov_filtered_tasic[ Alt5_coverages==\"None\" , `:=`( Alt5_coverages=0)]
ME_cov_filtered_tasic[ Alt3_coverages==\"None\" , `:=`( Alt3_coverages=0)]
ME_cov_filtered_tasic$total_cov_alternatives_5 <-  sapply(strsplit(as.character(ME_cov_filtered_tasic$Alt5_coverages), \",\", fixed=T), function(x) sum(as.numeric(x)))
ME_cov_filtered_tasic$total_cov_alternatives_3 <-  sapply(strsplit(as.character(ME_cov_filtered_tasic$Alt3_coverages), \",\", fixed=T), function(x) sum(as.numeric(x)))

ME_cov_filtered_tasic_primary_type <- ME_cov_filtered_tasic[, .(sum_ME_coverage=sum(sum_ME_coverage),
                          sum_SJ_coverage =sum(sum_SJ_coverage),
                          total_cov_alternatives_3 = sum(total_cov_alternatives_3),
                          total_cov_alternatives_5 = sum(total_cov_alternatives_5)
                          ), by=c(\"primary_type\", \"broad_type\", \"ME\") ]






ME_cov_filtered_tasic_primary_type[,PSI:=(sum_ME_coverage/(sum_ME_coverage+sum_SJ_coverage+total_cov_alternatives_3+total_cov_alternatives_5))]

min_PSI_sum <- 5
  
ME_cov_filtered_tasic_primary_type[sum_ME_coverage+sum_SJ_coverage+total_cov_alternatives_3+total_cov_alternatives_5<min_PSI_sum, PSI:=NaN]

library(Hmisc )

ME_cov_filtered_tasic_primary_type[ , 
            `:=`(
              lower=binconf(x=sum_ME_coverage, n=(sum_ME_coverage+sum_SJ_coverage+total_cov_alternatives_3+total_cov_alternatives_5) )[, \"Lower\"],
              upper=binconf(x=sum_ME_coverage, n=(sum_ME_coverage+sum_SJ_coverage+total_cov_alternatives_3+total_cov_alternatives_5) )[, \"Upper\"]
              ) ]



ME_cov_filtered_tasic_primary_type <- merge(ME_cov_filtered_tasic_primary_type, unique(gene_table.TOTAL), by=\"ME\")


ME_cov_filtered_tasic_primary_type.ME_clusters <- merge(ME_cov_filtered_tasic_primary_type, ME_clusters.info[, c(\"ME\", \"ME_cluster.type\", \"ME_cluster.name\")], by=\"ME\")





```"
