"0","```r


#Tissue_clusters_sum <- Tissue_clusters %>% group_by(cluster, name, age ) %>% summarise(count = n())

Tissue_clusters_DT <- data.table(Tissue_clusters)
Tissue_clusters_sum <- Tissue_clusters_DT[, .(count=.N) , by=c(\"cluster\", \"name\", \"age\" )]

Tissue_clusters_sum$age <- factor(Tissue_clusters_sum$age, levels= sort(as.numeric(as.character(levels(Tissue_clusters_sum$age)))) )


## NA ###

Tissue_clusters_sum$cluster <- factor(Tissue_clusters_sum$cluster , levels =PCA[, mean(PC1), by=\"cluster\" ][order(V1)]$cluster)


Tissue_clusters_sum <- merge(Tissue_clusters_sum, PCA[, .(mPC1=mean(PC1), mPC2=mean(PC2), mPC3=mean(PC3) ), by=\"cluster\" ][order(mPC1)], by=\"cluster\")
Tissue_clusters_sum[, `:=`(mean_PC1=round(mPC1, 2),mean_PC2=round(mPC2, 2), mean_PC3=round(mPC3, 2))  ]

Sup.Tissue_clusters.b.pre <- ggplot( Tissue_clusters_sum, aes(age, name) ) +
  geom_tile(aes(fill = count)) +
  scale_fill_gradient(low=\"grey\", high=\"red\")+
  facet_grid(. ~ cluster + mean_PC1 + mean_PC2 + mean_PC3, labeller = label_parsed ) +
  theme_bw()+
  labs(fill = \"Sample count\") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0),
    axis.title = element_text(colour = NA),
    strip.text = element_text(hjust = 0.5))


Sup.Tissue_clusters.c <- plot_grid(fake_plot.legend, Sup.Tissue_clusters.b.pre, ncol=1, rel_heights = c(0.1, 1) )
Sup.Tissue_clusters.c
```"
