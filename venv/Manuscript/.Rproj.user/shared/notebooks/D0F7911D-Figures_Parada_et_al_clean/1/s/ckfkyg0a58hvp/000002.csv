"0","```r

library(ggrepel)
library(cowplot)
library(readr)

PPI_genes <- read_delim(\"~/Google_Drive/Results/ME/Paper/PPI/ME.PPI.annotations.tsv\", 
    \"\t\", escape_double = FALSE, trim_ws = TRUE)

PPI_genes <- fread(\"../Figures/New_Figure 5/STRING/HMNF_ME_gene.STRING_map.txt\", sep=\"\t\")

Delta_HNMF_whippet_ME_age_diff_total


Delta_HNMF_whippet_ME_age_diff_total_PPI <- merge(Delta_HNMF_whippet_ME_age_diff_total, PPI_genes,  by.x=\"ensembl_gene_id\", by.y=\"input_term\")

PPI_diff_age_HNMF <- merge(Delta_HNMF_whippet_ME_age_diff_total_PPI, PPI_centrality, by=\"mapped_gene\")
  
  
  

#neuronal_ME_gene_names_diff_age <- merge(neuronal_ME_gene_names, PPI_centrality, by=\"mgi_symbol\")

#Delta_HNM_whippet_ME_age_diff_total[ , ensembl_gene_id:=gsub(\"\\..*\",\"\", Gene) ]


#PPI_diff_age_HNMF <- merge(Delta_HNMF_whippet_ME_age_diff_total, neuronal_ME_gene_names_diff_age, by=\"ensembl_gene_id\")

#PPI_diff_age_HNMF <- unique(PPI_diff_age_HNM)



PPI_diff_age_HNMF[ , type:=\"Annotated\"  ]

PPI_diff_age_HNMF[!exon_ID %in% microexons_Vastdb, type:=\"Missing in VastDB\"   ]

PPI_diff_age_HNMF[!exon_ID %in% microexons_GENCODE, type:=\"Missing in GENCODE\"   ]

PPI_diff_age_HNMF[!exon_ID %in% microexons_GENCODE & !exon_ID %in% microexons_Vastdb , type:=\"Novel\"   ]




L1int <- c(\"Ank1\", \"Ap2m1\", \"Kcnq2\", \"Nfasc\", \"Src\", \"Ank2\", \"Dnm1\", \"L1cam\", \"Nrcam\", \"Vav2\", \"Ank3\", \"Dnm3\", \"Ncam1\", \"Sptan1\")
#PPI_diff_age_HNM[, L1cam_and_interactors := mgi_symbol %in% L1int]


PPI_diff_age_HNMF_stats_HC <- PPI_diff_age_HNMF[,  .(min_dif_age=min(diff_age), Number_of_ME=.N), by=c(\"ensembl_gene_id\", \"harmonic_centrality\") ]
PPI_diff_age_HNMF_stats_HC[, rank:=frank(-harmonic_centrality)]
PPI_diff_age_HNMF_stats_HC[ , max_rank:=max(rank)]
PPI_diff_age_HNMF_stats_HC[ , percentil:=rank/max_rank*100]
PPI_diff_age_HNMF_stats_HC[, central:=FALSE]
PPI_diff_age_HNMF_stats_HC[percentil<15, central:=TRUE]


PPI_diff_age_HNMF_stats_B <- PPI_diff_age_HNMF[,  .(min_dif_age=min(diff_age), Number_of_ME=.N), by=c(\"ensembl_gene_id\", \"betweenness\") ]
PPI_diff_age_HNMF_stats_B[, rank:=frank(-betweenness)]
PPI_diff_age_HNMF_stats_B[ , max_rank:=max(rank)]
PPI_diff_age_HNMF_stats_B[ , percentil:=rank/max_rank*100]
PPI_diff_age_HNMF_stats_B[, central:=FALSE]
PPI_diff_age_HNMF_stats_B[percentil<15, central:=TRUE]


PPI_diff_age_HNMF_stats_EC <- PPI_diff_age_HNMF[,  .(min_dif_age=min(diff_age), Number_of_ME=.N), by=c(\"ensembl_gene_id\", \"eigen_centrality\", \"type\", \"mapped_gene\") ]
PPI_diff_age_HNMF_stats_EC[, rank:=frank(-eigen_centrality)]
PPI_diff_age_HNMF_stats_EC[ , max_rank:=max(rank)]
PPI_diff_age_HNMF_stats_EC[ , percentil:=rank/max_rank*100]
PPI_diff_age_HNMF_stats_EC[, central:=FALSE]
PPI_diff_age_HNMF_stats_EC[percentil<25, central:=TRUE]


PPI_diff_age_HNMF_central <- merge(PPI_diff_age_HNMF, PPI_diff_age_HNMF_stats_EC[, c(\"ensembl_gene_id\", \"central\")], by=\"ensembl_gene_id\" )


F6F <- ggplot(PPI_diff_age_HNMF_central) +
  geom_jitter(aes(eigen_centrality, diff_age,  colour= type  ), width=0, height=0.1) + 
  xlab(\"Eigencentrality\") +
  ylab(\"Earliest microexon differential inclusion detection (DPC)\") +
   scale_y_continuous(breaks=seq(10.5,16.5,1)) +
    geom_text_repel(data=PPI_diff_age_HNMF_central[  central==TRUE  ], 
                  aes(x=eigen_centrality, y=diff_age, colour= type ), 
                  nudge_y      = 0.5,
                  direction    = \"x\",
                  angle        = 90,
                  segment.size = 0.2,
                  label=PPI_diff_age_HNMF_central[central==TRUE  , mapped_gene],
                  show.legend = FALSE) +
          theme(axis.text.x = element_text(angle = 90), legend.position = \"top\", legend.direction = \"horizontal\") +
      theme(legend.position=\"none\")





PPI_diff_age_HNMF_central <- merge(PPI_diff_age_HNMF, PPI_diff_age_HNMF_stats_HC[, c(\"ensembl_gene_id\", \"central\")], by=\"ensembl_gene_id\" )


F6.sup.1 <- ggplot(PPI_diff_age_HNMF_central) +
  geom_jitter(aes(harmonic_centrality, diff_age,  colour= type  ), width=0, height=0.1) + 
  xlab(\"Harmonic Centrality\") +
  ylab(\"Earliest microexon differential inclusion detection (DPC)\") +
   scale_y_continuous(breaks=seq(10.5,16.5,1)) +
    geom_text_repel(data=PPI_diff_age_HNMF_central[  central==TRUE  ], 
                  aes(x=harmonic_centrality, y=diff_age, colour= type ), 
                  nudge_y      = 0.5,
                  direction    = \"x\",
                  angle        = 90,
                  segment.size = 0.2,
                  label=PPI_diff_age_HNMF_central[central==TRUE  , mapped_gene],
                  show.legend = FALSE) +
          theme(axis.text.x = element_text(angle = 90), legend.position = \"top\", legend.direction = \"horizontal\")

F6F
```"
