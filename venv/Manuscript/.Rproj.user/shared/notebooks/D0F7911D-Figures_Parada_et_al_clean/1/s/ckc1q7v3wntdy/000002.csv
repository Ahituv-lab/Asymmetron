"0","```r



ME_clusters_table[ , Diff_SKM:=\"FALSE\"]
ME_clusters_table[ME %in% Delta_SKM_whippet_ME[diff_high==TRUE & change_dir==1, exon_ID], Diff_SKM:=\"Excluded\" ]
ME_clusters_table[ME %in% Delta_SKM_whippet_ME[diff_high==TRUE & change_dir==-1, exon_ID], Diff_SKM:=\"Included\"]

ME_clusters_table[ , Diff_Heart:=\"FALSE\"]
ME_clusters_table[ME %in% Delta_Heart_whippet_ME[diff_high==TRUE & change_dir==1, exon_ID], Diff_Heart:=\"Excluded\" ]
ME_clusters_table[ME %in% Delta_Heart_whippet_ME[diff_high==TRUE & change_dir==-1, exon_ID], Diff_Heart:=\"Included\"]

ME_clusters_table[ , Diff_AG:=\"FALSE\"]
ME_clusters_table[ME %in% Delta_AG_whippet_ME[diff_high==TRUE & change_dir==1, exon_ID], Diff_AG:=\"Excluded\" ]
ME_clusters_table[ME %in% Delta_AG_whippet_ME[diff_high==TRUE & change_dir==-1, exon_ID], Diff_AG:=\"Included\"]





ME_clusters_table_stats_SKM <- ME_clusters_table[ Diff_SKM!=\"FALSE\", .N, by=c(\"ME_clusters\", \"Total\", \"Diff_SKM\") ]
ME_clusters_table_stats_SKM[, Percentage:=(N*100/Total)]
ME_clusters_table_stats_SKM[, Tissue:=\"SKM\"]
colnames(ME_clusters_table_stats_SKM) <- c(\"ME_clusters\", \"Total\", \"Diff\", \"N\", \"Percentage\", \"Tissue\" )

ME_clusters_table_stats_Heart <- ME_clusters_table[ Diff_Heart!=\"FALSE\", .N, by=c(\"ME_clusters\", \"Total\", \"Diff_Heart\") ]
ME_clusters_table_stats_Heart[, Percentage:=(N*100/Total)]
ME_clusters_table_stats_Heart[, Tissue:=\"HRT\"]
colnames(ME_clusters_table_stats_Heart) <- c(\"ME_clusters\", \"Total\", \"Diff\", \"N\", \"Percentage\", \"Tissue\" )

ME_clusters_table_stats_AG <- ME_clusters_table[ Diff_AG!=\"FALSE\", .N, by=c(\"ME_clusters\", \"Total\", \"Diff_AG\") ]
ME_clusters_table_stats_AG[, Percentage:=(N*100/Total)]
ME_clusters_table_stats_AG[, Tissue:=\"AD\"]
colnames(ME_clusters_table_stats_AG) <- c(\"ME_clusters\", \"Total\", \"Diff\", \"N\", \"Percentage\", \"Tissue\" )


ME_clusters_table_stats_SHA <- rbind(ME_clusters_table_stats_SKM, ME_clusters_table_stats_Heart, ME_clusters_table_stats_AG)



ME_clusters_table_stats_SHA <- merge(ME_clusters_table_stats_SHA, ME_cluster_names[, c(\"ME_cluster\", \"ME_cluster.name\", \"ME_cluster.type\")], by.x=\"ME_clusters\", by.y=\"ME_cluster\")

ME_clusters_table_stats_SHA_sub <- ME_clusters_table_stats_SHA[ME_cluster.name %in%  ME_cluster_names[ME_cluster.type %in% c(\"Neuronal\", \"Neuro-Muscular\", \"Muscular\", \"Non-Neuronal\"), ME_cluster.name], ]


ME_clusters_table_stats_SHA_sub$ME_cluster.name <- factor(ME_clusters_table_stats_SHA_sub$ME_cluster.name, levels = sort(unique(as.character(ME_clusters_table_stats_SHA_sub$ME_cluster.name))))




Fig5.D <- ggplot() +
  geom_bar(data=ME_clusters_table_stats_SHA_sub[Diff==\"Included\"], aes(factor(Tissue), Percentage), stat = \"identity\", fill=\"skyblue\") +
  geom_bar(data=ME_clusters_table_stats_SHA_sub[Diff==\"Excluded\"], aes(factor(Tissue), -Percentage), stat = \"identity\", fill=\"firebrick\") +
  facet_grid( ME_cluster.name ~ .) +
  ylim(c(-30, 75)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0),
    axis.title = element_text(colour = NA))
Fig5.D

```"
